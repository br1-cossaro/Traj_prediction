_target_: vehicle_traj.models.vehicle_transformer.VehicleTrajectoryTransformer

d_model: 128
num_layers: 3
num_heads: 4
dim_feedforward: 256
max_time: ${data.num_frames}
max_agents: ${data.max_agents}
obs_len: ${data.obs_len}
num_modes: 1
dropout: 0.1

use_velocity: ${inputs.use_velocity}
use_heading: ${inputs.use_heading}
use_type: ${inputs.use_type}
type_vocab_size: 16

use_map: ${inputs.use_map}
use_traffic_lights: ${inputs.use_traffic_lights}

# Cross-attention context injection (keeps agent token sequence fixed).
map_integration: cross_attn_per_layer
tl_integration: cross_attn_per_layer

# Polyline encoder: consume full roadgraph polylines [B,G,P,3] (xy + type_id)
# instead of centroid map_tokens.
map_use_polyline_encoder: true
map_polyline_encoder: attn
map_polyline_max_points: 20

# Treat categorical ids as embeddings (recommended with polyline encoder).
map_use_type_embedding: true
map_type_vocab_size: 64
tl_use_state_embedding: true
tl_state_vocab_size: 16
tl_use_time_embedding: true
tl_time_vocab_size: 16
