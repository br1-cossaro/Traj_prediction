_target_: vehicle_traj.models.urban_transformer.UrbanVehicleTransformer

d_model: 128
num_layers: 4
num_heads: 4
dim_feedforward: 256
max_time: ${data.num_frames}
max_agents: ${data.max_agents}
obs_len: ${data.obs_len}
num_modes: 6
dropout: 0.1

use_velocity: ${inputs.use_velocity}
use_heading: ${inputs.use_heading}
use_type: ${inputs.use_type}
type_vocab_size: 16

use_map: ${inputs.use_map}
use_traffic_lights: ${inputs.use_traffic_lights}
map_integration: cross_attn
tl_integration: cross_attn
map_feat_dim: 3
traffic_light_feat_dim: 4  # xy + state/time when present

use_agent_map_feat: false
agent_map_feat_dim: 4
